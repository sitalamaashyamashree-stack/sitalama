<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Contest Result Portal</title>

  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;700&family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: "Poppins", sans-serif;
      color: white;
      overflow: hidden;
      padding: 20px;
      background: radial-gradient(circle at top, #0f172a, #020617);
    }

    /* Animated Background */
    .bg {
      position: absolute;
      width: 100%;
      height: 100%;
      overflow: hidden;
      z-index: -1;
    }

    .blob {
      position: absolute;
      width: 420px;
      height: 420px;
      border-radius: 50%;
      filter: blur(90px);
      opacity: 0.7;
      animation: float 8s infinite alternate ease-in-out;
    }

    .blob:nth-child(1) {
      background: #38bdf8;
      top: -140px;
      left: -140px;
    }

    .blob:nth-child(2) {
      background: #a855f7;
      bottom: -160px;
      right: -160px;
      animation-delay: 2s;
    }

    .blob:nth-child(3) {
      background: #22c55e;
      top: 45%;
      left: 65%;
      width: 320px;
      height: 320px;
      animation-delay: 4s;
    }

    @keyframes float {
      from { transform: translateY(0px) translateX(0px); }
      to { transform: translateY(50px) translateX(40px); }
    }

    /* Main Card */
    .container {
      width: 100%;
      max-width: 620px;
      padding: 45px;
      border-radius: 24px;
      background: rgba(255, 255, 255, 0.07);
      backdrop-filter: blur(18px);
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0px 0px 45px rgba(56, 189, 248, 0.25);
      animation: fadeIn 1s ease;
      position: relative;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0px); }
    }

    .header {
      text-align: center;
      margin-bottom: 30px;
    }

    .header h1 {
      font-family: "Orbitron", sans-serif;
      font-size: 32px;
      font-weight: 700;
      letter-spacing: 2px;
      background: linear-gradient(90deg, #38bdf8, #a855f7, #22c55e);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 14px;
      opacity: 0.85;
    }

    .input-box {
      display: flex;
      gap: 12px;
      margin-bottom: 22px;
    }

    input {
      flex: 1;
      padding: 16px 18px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgba(0,0,0,0.25);
      outline: none;
      color: white;
      font-size: 15px;
      transition: 0.3s;
    }

    input:focus {
      border: 1px solid #38bdf8;
      box-shadow: 0px 0px 18px rgba(56, 189, 248, 0.5);
      transform: scale(1.01);
    }

    button {
      padding: 16px 20px;
      border: none;
      border-radius: 14px;
      cursor: pointer;
      font-weight: 800;
      font-size: 14px;
      letter-spacing: 1px;
      color: white;
      background: linear-gradient(135deg, #38bdf8, #2563eb, #a855f7);
      transition: 0.3s;
      box-shadow: 0px 0px 20px rgba(56, 189, 248, 0.35);
    }

    button:hover {
      transform: translateY(-3px) scale(1.02);
      box-shadow: 0px 0px 35px rgba(168, 85, 247, 0.55);
    }

    .loader {
      margin: 20px auto;
      width: 38px;
      height: 38px;
      border: 4px solid rgba(255,255,255,0.2);
      border-top: 4px solid #38bdf8;
      border-radius: 50%;
      animation: spin 1s linear infinite;
      display: none;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .error {
      text-align: center;
      color: #fb7185;
      font-weight: 700;
      margin-top: 12px;
      display: none;
      animation: fadeIn 0.5s ease;
    }

    /* Result Card */
    .result-card {
      margin-top: 22px;
      padding: 26px;
      border-radius: 18px;
      background: rgba(255,255,255,0.06);
      border: 1px solid rgba(255,255,255,0.12);
      display: none;
      animation: fadeIn 0.6s ease;
      box-shadow: 0px 0px 25px rgba(56, 189, 248, 0.15);
    }

    .row {
      display: flex;
      justify-content: space-between;
      padding: 12px 0;
      border-bottom: 1px solid rgba(255,255,255,0.08);
      font-size: 14px;
    }

    .row:last-child {
      border-bottom: none;
    }

    .label {
      opacity: 0.7;
    }

    .value {
      font-weight: 800;
      text-align: right;
    }

    .remarks-box {
      margin-top: 18px;
      padding: 18px;
      border-radius: 14px;
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.08);
      text-align: center;
      font-size: 14px;
      line-height: 1.6;
      font-weight: 600;
      opacity: 0.95;
    }

    .badge {
      margin-top: 20px;
      display: inline-block;
      width: 100%;
      padding: 14px;
      border-radius: 14px;
      font-size: 16px;
      font-weight: 900;
      text-align: center;
      letter-spacing: 1px;
    }

    .pass {
      background: rgba(34, 197, 94, 0.18);
      border: 1px solid rgba(34, 197, 94, 0.6);
      color: #22c55e;
      box-shadow: 0px 0px 18px rgba(34, 197, 94, 0.3);
    }

    .fail {
      background: rgba(239, 68, 68, 0.18);
      border: 1px solid rgba(239, 68, 68, 0.6);
      color: #ef4444;
      box-shadow: 0px 0px 18px rgba(239, 68, 68, 0.3);
    }

    .pending {
      background: rgba(234, 179, 8, 0.18);
      border: 1px solid rgba(234, 179, 8, 0.6);
      color: #facc15;
      box-shadow: 0px 0px 18px rgba(234, 179, 8, 0.25);
    }

    .footer {
      margin-top: 25px;
      text-align: center;
      font-size: 12px;
      opacity: 0.65;
    }
  </style>
</head>

<body>

  <div class="bg">
    <div class="blob"></div>
    <div class="blob"></div>
    <div class="blob"></div>
  </div>

  <div class="container">

    <div class="header">
      <h1>RESULT PORTAL</h1>
      <p>Enter your Contestant Code to check your status & remarks</p>
    </div>

    <div class="input-box">
      <input type="text" id="codeInput" placeholder="Enter Contestant Code (Example: CON0001)">
      <button onclick="findResult()">CHECK</button>
    </div>

    <div class="loader" id="loader"></div>
    <div class="error" id="errorMsg"></div>

    <div class="result-card" id="resultCard">
      <div class="row">
        <div class="label">Contestant Code</div>
        <div class="value" id="codeOut"></div>
      </div>

      <div class="remarks-box" id="remarksOut"></div>

      <div id="badgeOut"></div>
    </div>

    <div class="footer">‚ö° Powered by Google Sheets Live Result System</div>
  </div>

  <script>
    const SHEET_URL =
      "https://docs.google.com/spreadsheets/d/1oO8IYzivUZ-I41uUT-ZFKoxPyLB-ngdSfPbAPerNikI/gviz/tq?tqx=out:csv";

    let sheetData = [];

    function parseCSV(text) {
      const rows = [];
      let row = [];
      let cell = "";
      let insideQuotes = false;

      for (let i = 0; i < text.length; i++) {
        const char = text[i];
        const nextChar = text[i + 1];

        if (char === '"' && insideQuotes && nextChar === '"') {
          cell += '"';
          i++;
        } else if (char === '"') {
          insideQuotes = !insideQuotes;
        } else if (char === "," && !insideQuotes) {
          row.push(cell);
          cell = "";
        } else if (char === "\n" && !insideQuotes) {
          row.push(cell);
          rows.push(row);
          row = [];
          cell = "";
        } else {
          cell += char;
        }
      }

      if (cell.length > 0) {
        row.push(cell);
        rows.push(row);
      }

      return rows;
    }

    async function loadSheetData() {
      const response = await fetch(SHEET_URL);
      const text = await response.text();

      const rows = parseCSV(text.trim());
      rows.shift(); // remove headers

      sheetData = rows.map(r => ({
        code: (r[1] || "").trim().toUpperCase(),
        result: (r[2] || "").trim().toUpperCase(),
        remarks: (r[3] || "").trim()
      }));

      console.log("Loaded Sheet Data:", sheetData);
    }

    async function findResult() {
      const inputCode = document.getElementById("codeInput").value.trim().toUpperCase();

      const loader = document.getElementById("loader");
      const errorMsg = document.getElementById("errorMsg");
      const resultCard = document.getElementById("resultCard");

      errorMsg.style.display = "none";
      resultCard.style.display = "none";
      loader.style.display = "block";

      if (inputCode === "") {
        loader.style.display = "none";
        errorMsg.style.display = "block";
        errorMsg.innerText = "‚ö† Please enter your contestant code.";
        return;
      }

      try {
        if (sheetData.length === 0) {
          await loadSheetData();
        }
      } catch (err) {
        loader.style.display = "none";
        errorMsg.style.display = "block";
        errorMsg.innerText = "‚ùå Unable to load results. Please make sure sheet is public.";
        console.log("Fetch Error:", err);
        return;
      }

      loader.style.display = "none";

      const found = sheetData.find(item => item.code === inputCode);

      if (!found) {
        errorMsg.style.display = "block";
        errorMsg.innerText = "‚ùå Code Not Found. Please check again.";
        return;
      }

      document.getElementById("codeOut").innerText = found.code;

      document.getElementById("remarksOut").innerHTML =
        found.remarks
          ? found.remarks
          : "No remarks available.";

      let badgeClass = "pending";
let badgeText = "NOT PUBLISHED ‚è≥";

// If remarks exist, show Published
if (found.remarks && found.remarks.trim() !== "") {
  badgeClass = "pass";
  badgeText = "‚úÖ PUBLISHED";
}

// PASS / FAIL overrides published
if (found.result.includes("PASS")) {
  badgeClass = "pass";
  badgeText = "üéâ PASS ‚úÖ";
} else if (found.result.includes("FAIL")) {
  badgeClass = "fail";
  badgeText = "‚ùå FAIL";
}


      document.getElementById("badgeOut").innerHTML =
        `<div class="badge ${badgeClass}">${badgeText}</div>`;

      resultCard.style.display = "block";
    }

    // Enter key support
    document.getElementById("codeInput").addEventListener("keypress", function(event) {
      if (event.key === "Enter") {
        findResult();
      }
    });
  </script>

</body>
</html>
